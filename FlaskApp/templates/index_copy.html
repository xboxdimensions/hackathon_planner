<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course planner</title>

	<style>
		body {
			font-family: Helvetica, sans-serif;
			background-color: #4b0082;
			margin: 20px;
			color: white;
		}
	
		.title {
			font-size: larger;
			text-align: center;
			color: white;
			margin-bottom: 30px;
		}
	
		.textBar {
			text-align: center;
			margin-bottom: 20px;
		}
	
		#courseSelect {
			width: 50%;
			height: 5vh;
			font-size: 18px;
			border-radius: 4px;
			border: 1px solid #ccc;
			padding: 0 10px;
		}
	
		.options {
			text-align: center;
			margin-bottom: 30px;
		}
	
		.options select {
			margin: 0 10px;
			width: 15%;
			height: 5vh;
			font-size: 18px;
			border-radius: 4px;
			border: 1px solid #ccc;
			padding: 0 10px;
		}
	
		.content {
			display: flex;
			justify-content: space-between; /* Ensures space between .plan and .rhs */
			align-items: flex-start; /* Aligns items at the start of the container */
		}
	
		.plan {
			width: 65%;
			padding-right: 20px;
			margin-bottom: 10px;
			box-sizing: border-box;
		}

		.plan h1 {
			margin: 0;
		}
	
		.semesters {
			background-color: #fff;
			padding: 20px;
			border-radius: 8px;
			box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
			color: #333;
			overflow-y: scroll; /* Always show vertical scroll */
			max-height: 60vh; /* Set maximum height for scroll */
		}
	
		.semesters h2 {
			color: #4b0082;
			margin-bottom: 20px;
			text-align: center;
		}
	
		.semester {
			padding: 10px;
			margin: 10px 0;
			background-color: #f9f9f9;
			border: 2px dashed #ccc;
			border-radius: 4px;
			text-align: center;
			min-height: 6vh;
			transition: transform 0.3s ease;
		}
	
		.rhs {
			width: 30%;
			display: flex;
			flex-direction: column;
			box-sizing: border-box;
		}
	
		#courseAdd {
			margin-bottom: 20px;
		}
	
		#courseAdd input[type="text"] {
			width: 60%;
			height: 5vh;
			font-size: 18px;
			border-radius: 4px;
			border: 2px solid #ccc;
			padding: 0 10px;
		}
	
		#courseAdd input[type="submit"] {
			height: 5vh;
			width: 30%;
			font-size: 18px;
			border-radius: 4px;
			background-color: white;
			color: #4b0082;
			border: none;
			cursor: pointer;
		}
	
		#relevant, #availiable {
			background-color: #fff;
			border-radius: 8px;
			box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
			color: #333;
			padding: 10px;
			margin-bottom: 20px;
			max-height: 70vh; /* Set maximum height for scroll */
			overflow-y: scroll; /* Always show vertical scroll */
			overflow-x: hidden;
			text-align: center;
		}
	
		#relevant h2, #availiable h2 {
			color: #4b0082;
			margin-bottom: 10px;
		}
	
		/* Custom Scrollbar */
		::-webkit-scrollbar {
			width: 10px;
		}
	
		::-webkit-scrollbar-thumb {
			border-radius: 5px;
			background-color: rgba(0, 0, 0, 0.5);
		}
	</style>
	
</head>

<body>
	<!-- Title -->
	<div class="title"><h1>UQ Program Planner</h1></div>
	
	<!-- User Input -->
	<div class="textBar">
		<select id="courseSelect">
			<option value="">Select Your Program</option>
		</select>
	</div>
	<div class="options">
		<select id="plan">
			<option selected>Select Plan</option>
		</select>
		<select id="startingYear">
			<option value="2024" selected>2024</option>
		</select>
		<select id="load">
			<option value="full" selected>Full time</option>
			<option value="part">Part time</option>
		</select>
	</div>

	<!-- Content -->
	<div class="content">
		<!-- Plan -->
		<div class="plan">
			<!-- Semesters -->
			<h1>Your Plan</h1>
			<div class="semesters">
			</div>
		</div>		

		<!-- RHS content -->
		<div class="rhs">
			<!-- Course add -->
			<div id="courseAdd">
				<form>
					<input type="text" placeholder="Add a course code" id="cCodeInput">
					<input type="submit" value="Add">
				</form>
			</div>

			<!-- Relevant Courses -->
			<div id="relevant">
				<h2>Relevant Courses</h2>
				<div>You have no relevant courses to add.</div>
			</div>

			<!-- Available Courses -->
			<div id="availiable">
				<h2>Available Courses</h2>
				<div>You have no available courses to add.</div>
			</div>
		</div>
	</div>
</body>

<script>
	/**
	 * 
	 * Code for the divs etc
	*/

	// populating the select year

	let dateDropdown = document.getElementById('startingYear');
	let planDiv = document.getElementsByClassName("semesters")[0];


	let currentYear = new Date().getFullYear();
	let latestYear = currentYear+10;

	let i = 0;
	while (currentYear <= latestYear) {
	let dateOption = document.createElement('option');
	dateOption.text = currentYear;
	dateOption.value = currentYear;

	let yearTitle = document.createElement('h2');
	yearTitle.innerHTML = currentYear;
	if (currentYear == 2024) {
			yearTitle.style.marginTop = 0;
	}
	console.log(yearTitle);
	
	

	let sem1Div = document.createElement('div');
	let sem2Div = document.createElement('div');

	sem1Div.textContent = "Semester 1";
	sem1Div.align = "left"
	sem2Div.align = "right"
	sem2Div.textContent = "Semester 2"; 

	sem1Div.classList.add("semester");
	sem2Div.classList.add("semester");
	

	sem1Div.ondrop = "drop(event)";
	sem2Div.ondrop = "drop(event)";

	
	sem1Div.ondragover = "allowDrop(event)";
	sem2Div.ondragover = "allowDrop(event)";

	sem1Div.ondragleave = "dragLeave(event)";
	sem2Div.ondragleave = "dragLeave(event)";

	sem1Div.id = "semester" + i;
	i++;
	sem2Div.id = "semester" + i;
	i++;

	
	dateDropdown.add(dateOption);
	planDiv.appendChild(yearTitle);
	planDiv.appendChild(sem1Div);
	planDiv.appendChild(sem2Div);

	
	currentYear += 1;
	}

	// end of semesters




	document.querySelectorAll('.course').forEach(course => {
		course.addEventListener('dragstart', drag);
		course.addEventListener('dragend', function() {
			this.classList.remove('dragging');
		});
	});

	function allowDrop(event) {
		event.preventDefault();
		event.currentTarget.classList.add('over');
	}
	
	function dragLeave(event) {
		
		
		event.preventDefault();
		event.currentTarget.classList.remove('over');
	}

	function drop(event) {
		event.preventDefault();
		const data = event.dataTransfer.getData('text'); // text of the box
		const course = document.getElementById(data); // the course box being dragged
		const semester = event.currentTarget; // the place we drop to

	
		if (semester.id == "cou") { // if we are dragging into the course list
	 
			
				semester.appendChild(course); // add to course list 
			} else if (semester.id === 'semester1' && semester.querySelectorAll('.course').length >= 4) {
			alert('You cannot have more than 4 courses in the first semester of the first year.');
		} else if (semester.querySelectorAll('.course').length >= 5) {
			alert('You cannot have more than 5 courses in a semester.');
		} else {
			 // otherwise we are doing CHECKS and adding to semester 
	   
			 semester.appendChild(course);
			   
				
			}
		
		semester.classList.remove('over');
		course.classList.remove('dragging');
	}
	function drag(event) {
		event.dataTransfer.setData('text', event.target.id);
		event.target.classList.add('dragging');
	}
	document.getElementById('startingYear').addEventListener('change', function() {
		const startingYear = this.value - 1;
		const semesterContainers = document.querySelectorAll('.semesters h2');

		semesterContainers.forEach((container, index) => {
			const year = parseInt(startingYear) + index;
			container.textContent = year;
		});
		
	});
	const degreeCourses = {
  "1602": "Diploma in Languages",
  "2000": "Arts",
  "2007": "Agribusiness",
  "2031": "Science (Honours)",
  "2033": "Social Science (Honours)",
  "2040": "Journalism",
  "2041": "Journalism (Honours)",
  "2052": "Arts (Honours)",
  "2063": "Regional and Town Planning",
  "2066": "Arts / Education (Secondary)",
  "2102": "Journalism / Arts",
  "2129": "Business Management (Honours)",
  "2131": "Commerce (Honours)",
  "2132": "Economics (Honours)",
  "2139": "Advanced Business (Honours)",
  "2140": "Advanced Finance and Economics (Honours)",
  "2142": "Arts / Laws (Honours)",
  "2171": "Business Management",
  "2175": "Business Management / Arts",
  "2180": " of Business Management / Commerce",
  "2181": "Business Management / Economics",
  "2235": "Information Technology (Honours)",
  "2237": "Communication (Honours)",
  "2241": "Nursing",
  "2243": "Nursing (Honours)",
  "2252": "Health Sciences",
  "2253": "Health Sciences (Honours)",
  "2261": "Midwifery",
  "2264": "Human Services (Honours)",
  "2266": "Midwifery (Honours)",
  "2290": "Nursing / Midwifery",
  "2293": "Architectural Design",
  "2298": "Business Management / Education (Secondary)",
  "2299": "Business Management / Information Technology",
  "2306": "Education (Primary)",
  "2312": "Education (Secondary)",
  "2316": "International Studies",
  "2317": "International Studies (Honours)",
  "2320": "Diploma in Arts",
  "2334": "Business Management / Laws (Honours)",
  "2335": "Business Management / Science",
  "2336": "Commerce",
  "2337": "Commerce / Arts",
  "2338": "Commerce / Economics",
  "2339": "Commerce / Information Technology",
  "2350": "Engineering (Honours) and Master of Engineering",
  "2354": "Science (Honours) - Gatton",
  "2355": "Music (Honours)",
  "2357": "Music (Honours) / Education (Secondary)",
  "2367": "Dental Science (Honours)",
  "2368": "Occupational Therapy (Honours)",
  "2369": "Physiotherapy (Honours)",
  "2370": "Speech Pathology (Honours)",
  "2371": "Exercise and Sport Sciences (Honours)",
  "2372": "Health, Sport and Physical Education (Honours)",
  "2373": "Pharmacy (Honours)",
  "2376": "Environmental Management (Honours)",
  "2378": "Veterinary Science (Honours)",
  "2379": "Psychological Science (Honours)",
  "2380": "Education (Primary) (Honours)",
  "2381": "Regional and Town Planning (Honours)",
  "2382": "Social Work (Honours)",
  "2387": "Veterinary Technology",
  "2388": "Wildlife Science",
  "2392": "Agribusiness / Wildlife Science",
  "2405": "Music (Honours) / Arts",
  "2413": "Clinical Exercise Physiology (Honours)",
  "2414": "Advanced Humanities (Honours)",
  "2415": "Biomedical Science",
  "2417": "Equine Science (Honours)",
  "2419": "Wildlife Science (Honours)",
  "2421": "Mathematics (Honours)",
  "2422": "Veterinary Technology (Honours)",
  "2423": "Biomedical Science (Honours)",
  "2448": "Agricultural Science",
  "2449": "Agribusiness / Agricultural Science",
  "2450": "Agricultural Science (Honours)",
  "2451": "Computer Science",
  "2452": "Computer Science (Honours)",
  "2453": "Information Technology",
  "2454": "Design",
  "2455": "Engineering (Honours)",
  "2456": "Biotechnology",
  "2457": "Biotechnology (Honours)",
  "2458": "Environmental Science",
  "2459": "Environmental Science (Honours)",
  "2460": "Mathematics",
  "2461": "Science",
  "2463": "Computer Science / Business Management",
  "2464": "Computer Science / Commerce",
  "2465": "Commerce / Laws (Honours)",
  "2466": "Commerce / Science",
  "2467": "Economics",
  "2468": "Economics / Arts",
  "2469": "Economics / Laws (Honours)",
  "2470": "Economics / Science",
  "2471": "Laws (Honours)",
  "2472": "Science / Laws (Honours)",
  "2473": "Tourism, Hospitality and Event Management"
}


for (const courseCode in degreeCourses) {
document.getElementById("courseSelect").innerHTML += `<option value="${courseCode}">${degreeCourses[courseCode]}</option>`;
}

// Add event listener to the select element to get the selected course code
// Add event listener to the select element to get the selected course code
// Add event listener to the select element to get the selected course code
document.getElementById('courseSelect').addEventListener('change', function() {
	const ProgramCode = this.value;

	// Make a fetch request to the server-side API endpoint
	const response = fetch('http://127.0.0.1:5000/api', {
		method: 'POST',
		headers: {
			'Content-Type': 'application/json'
		},
		
		body: JSON.stringify({ProgramCode: ProgramCode, 
			startingYear: document.getElementById('starting-year').value,
		Load: document.getElementById('laod').value})
	})
	.then(response => response.json())
	.then(data => {
		// Clear all children before appending new courses
		document.getElementById("cou").innerHTML = '';
		for (const Avcourse in data.AvailiableCourses) {
			if (data.AvailiableCourses[Avcourse].length < 9){
				const newCourse = document.createElement('div');
			newCourse.classList.add('course');
			newCourse.classList.add('optional');
			newCourse.textContent = data.AvailiableCourses[Avcourse];
			newCourse.id = newCourse.textContent;
			newCourse.draggable = true;
			newCourse.addEventListener('dragstart', drag);
			newCourse.addEventListener('dragend', function() {
				this.classList.remove('dragging');
			});
			// Append the new course to the availiable courses
			document.getElementById("cou").appendChild(newCourse);
			}
		}
		int = 0;
		for (year in (data.Plan)){
			for(semester in data.Plan[year]){
				int +=1
				document.getElementById(`semester${int}`).innerHTML = '';
				document.getElementById(`semester${int}`).textContent = "Semester " + int;
				for(course in data.Plan[year][semester]){
					const newCourse = document.createElement('div');
					newCourse.classList.add('course');
					newCourse.classList.add('required')
					newCourse.draggable = true;
					newCourse.id =  data.Plan[year][semester][course];
					newCourse.textContent = data.Plan[year][semester][course];
					newCourse.addEventListener('dragstart', drag);
					newCourse.addEventListener('dragend', function() {
						this.classList.remove('dragging');
					});
					
					document.getElementById(`semester${int}`).appendChild(newCourse);
				}
				
			}
		}
		// Re-add drag and drop event listeners to the courses
	})
	.catch((error) => {
		console.error('Error:', error);
	});
});

</script>

</html>
